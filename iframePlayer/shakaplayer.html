<!DOCTYPE html>
<html lang="hk">
<head>
    <meta charset="UTF-8">

    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mux.js@5.1.3/dist/mux.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/2.5.9/shaka-player.compiled.js"></script>
</head>
<body>
<div id="player-display"></div>
<script type="text/javascript">
  /**
   * 播放器
   * */
  var player;

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去將Player播放
   * 由於因依家啲瀏覽器唔準(出聲)自動播放
   * 並且對開發程式人員講: "唔好諗住一定可以自動播放"
   * 基於此 為有增加一個按扭備不時之需讓觀眾點擊播放
   * */
  function onSetIframePlayerPlay(){

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去設定videoTrack
   *
   * @param {videoTrack: TrackDescription} videoTrack 當執行設定videoTrack時嘅videoTrack參數
   * */
  function onSetIframePlayerVideoTrack(videoTrack) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去獲取videoTrack
   *
   * @param {(videoTrack: TrackDescription)=>{})} onReturn 執行此CallBackFunction去return個videoTrack
   * */
  function onGetIframePlayerVideoTrack(onReturn) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去獲取所有videoTrack資訊
   *
   * @param {(videoTracks: TrackDescription[])=>{})} onReturn 執行此CallBackFunction去return所有videoTrack資訊
   * */
  function onGetIframePlayerVideoTracks(onReturn) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去設定audioTrack
   *
   * @param {audioTrack: TrackDescription} audioTrack 當執行設定audioTrack時嘅audioTrack參數
   * */
  function onSetIframePlayerAudioTrack(audioTrack) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去獲取audioTrack
   *
   * @param {(audioTrack: TrackDescription)=>{})} onReturn 執行此CallBackFunction去return個audioTrack
   * */
  function onGetIframePlayerAudioTrack(onReturn) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去獲取所有audioTrack資訊
   *
   * @param {(audioTracks: TrackDescription[])=>{})} onReturn 執行此CallBackFunction去return所有audioTrack資訊
   * */
  function onGetIframePlayerAudioTracks(onReturn) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去設定subtitleTrack
   *
   * @param {subtitleTrack: TrackDescription} subtitleTrack 當執行設定subtitleTrack時嘅subtitleTrack參數
   * */
  function onSetIframePlayerSubtitleTrack(subtitleTrack) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去獲取subtitleTrack
   *
   * @param {(subtitleTrack: TrackDescription)=>{})} onReturn 執行此CallBackFunction去return個subtitleTrack
   * */
  function onGetIframePlayerSubtitleTrack(onReturn) {

  }

  /**
   * 由HKNBP_Core開啟呢個IframePlayer去獲取所有subtitleTrack資訊
   *
   * @param {(subtitleTracks: TrackDescription[])=>{})} onReturn 執行此CallBackFunction去return所有subtitleTrack資訊
   * */
  function onGetIframePlayerSubtitleTracks(onReturn) {

  }

  /**
   * 由HKNBP_Core發出音量值讀取
   *
   * @param {volume: Number} volume 欲設音量 數值由0-100之間,100為最大音量
   * */
  function onSetIframePlayerVolume(volume) {

  }

  /**
   * 由HKNBP_Core發出音量值讀取
   *
   * @param {(volume: Number)=>{})} onReturn 執行此CallBackFunction去return現在音量 數值由0-100之間,100為最大音量
   * */
  function onGetIframePlayerVolume(onReturn) {

  }

  /**
   * 由HKNBP_Core發出靜音值讀取
   *
   * @param {muted: Boolean} muted 欲設靜音
   * */
  function onSetIframePlayerMuted(muted) {

  }

  /**
   * 由HKNBP_Core發出靜音值讀取
   *
   * @param {(muted: Boolean)=>{})} onReturn 執行此CallBackFunction去return個靜音值 靜左音(true) 或 未靜音(false)
   * */
  function onGetIframePlayerMuted(onReturn) {

  }

  /**
   * 由HKNBP_Core發出片源解像度值讀取
   *
   * @param {(resolution: Number[])=>{})} onReturn 執行此CallBackFunction去return個解像度 array[0]為寬 array[1]為高
   * */
  function onGetIframePlayerVideoResolution(onReturn){

  }

  /**
   * 由HKNBP_Core發出當觀眾按Programmable鍵
   *
   * @param {color: String} color Programmable鍵顏色
   * */
  function onClickProgrammableButton(color){

  }

  /**
   * 由HKNBP_Core發出初始化IframePlayer
   *
   * @param {source: String} source 頻道源
   * */
  function onIframePlayerInit(sourceSrc){
      document.getElementById("player-display").innerHTML = "" +
          "<video " +
          "   id=\"player\" " +
          "   class=\"video-js vjs-default-skin\" " +
          "   controls preload=\"auto\" " +
          "   onplaying=\"onIframePlayerPlaying()\" " +
          "   onpause=\"onIframePlayerNotPlaying()\" " +
          "   onstop=\"onIframePlayerNotPlaying()\" " +
          "   onended=\"onIframePlayerNotPlaying()\" " +
          "   onerror=\"onIframePlayerNotPlaying()\" " +
          "   onwaiting=\"onIframePlayerNotPlaying()\" " +
          "   oncanplaythrough=\"this.play()\" " +
          "   data-setup='{}' " +
          "   style=\"position:absolute; top:0; bottom:0; left:0; right:0; width:100%; height:100%; overflow:hidden;\"" +
          "   frameBorder=\"0\"" +
          "   poster=\"../img/nullIcon.png\"" +
          "   allow=\"autoplay; fullscreen;\" muted playsinline>" +
          "</video>";
      function onError(error) {
          // Log the error.
          console.error('Error code', error.code, 'object', error);
      }
      function onErrorEvent(event) {
          // Extract the shaka.util.Error object from the event.
          onError(event.detail);
      }
      function initPlayer() {
          // Create a Player instance.
          var video = document.getElementById('player');
          var player = new shaka.Player(video);
          // Attach player to the window to make it easy to access in the JS console.
          window.player = player;
          // Listen for error events.
          player.addEventListener('error', onErrorEvent);
          // Try to load a manifest.
          // This is an asynchronous process.
          player.load(sourceSrc).then(function() {
              // This runs if the asynchronous load is successful.
              console.log('The video has now been loaded!');
          }).catch(onError);  // onError is executed if the asynchronous load fails.
      }
      function initApp() {
          // Install built-in polyfills to patch browser incompatibilities.
          shaka.polyfill.installAll();
          // Check to see if the browser supports the basic APIs Shaka needs.
          if (shaka.Player.isBrowserSupported()) {
              // Everything looks good!
              initPlayer();
          } else {
              // This browser does not have the minimum set of APIs we need.
              console.error('Browser not supported!');
          }
      }
      document.addEventListener('DOMContentLoaded', initApp);
  }
</script>
<script type="text/javascript" src="hknbp-iframeplayer-bridge.js"></script>
</body>
</html>
